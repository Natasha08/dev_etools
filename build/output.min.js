var mysql=require("mysql"),express=require("express"),path=require("path"),favicon=require("serve-favicon"),logger=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),expressSession=require("express-session"),passport=require("passport"),LocalStrategy=require("passport-local").Strategy,connection=require("./public/javascripts/require.js"),easyPbkdf2=require("easy-pbkdf2")();const crypto=require("crypto");var routesf=require("./routes/efridge"),routesg=require("./routes/egym"),routes=require("./routes/index"),routesl=require("./routes/login"),app=express();app.set("views",path.join(__dirname,"views")),app.set("view engine","ejs"),app.use(logger("dev")),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.use(cookieParser()),app.use(expressSession({secret:process.env.SESSION_SECRET||"woiefjwafo;ajwefoewifjaweof;jiawef;oweijf;awoefijaw;foijew;eofijaeofjef'pweofFJEAFIOAEJFALRJ3P28U4TO3WF5ILGJ;OTIJWE;T/OIJTGWPAIT'JKL/MQRA;wozesnfpoaij;eirjw;3eorakljtmw;isoejta",resave:!1,saveUninitialized:!1})),app.use(require("less-middleware")(path.join(__dirname,"public"))),app.use(express["static"](path.join(__dirname,"public"))),app.use(passport.initialize()),app.use(passport.session()),passport.use("local-login",new LocalStrategy({usernameField:"email",passwordField:"password",passReqToCallback:!0},function(a,b,c,d){connection.query("SELECT * FROM `users` WHERE `email` = '"+b+"'",function(b,c){var e={password:a.body.password,salt:c[0].user_salt};const f=crypto.pbkdf2Sync(e.password,e.salt,1e5,512,"sha512");var g=f.toString("hex");return b?d(b):c.length?c[0].password!=g?(d(null,!1),console.log("something is wrong with the buffers!"+c[0].password)):c[0].user_salt!=e.salt?(d(null,!1),console.log("saltless")):(d(null,c[0]),console.log("You are successfully logged in!")):(d(null,!1),console.log("no error, and no user either!"))})})),passport.serializeUser(function(a,b){b(null,a.user_id)}),passport.deserializeUser(function(a,b){connection.query("select * from users where user_id = "+a,function(a,c){b(a,c[0])})}),app.use("/",routes),app.use("/",routesg),app.use("/",routesf),app.use("/",routesl),app.use(function(a,b,c){var d=new Error("Not Found");d.status=404,c(d)}),app.use(function(a,b,c,d){c.status(a.status||500),c.render("error",{message:a.message,error:{}})}),module.exports=app;var express=require("express"),routerf=express.Router(),mysql=require("mysql"),connection=require("../public/javascripts/require"),expressSession=require("express-session"),passport=require("passport"),passportLocal=require("passport-local");routerf.get("/logout",function(a,b){a.logout(),b.redirect("/")}),routerf.get("/efridge",function(a,b,c){var d={isAuthenticated:a.isAuthenticated(),user:a.user};if(d.isAuthenticated){var e;connection.query("select * from  efridge where user_id = "+d.user.user_id,function(c,d){e=d,b.render("efridge",{title:"My e-fridge",description:"Enter the name of the food in your e-fridge that you want to add to today's meal.",data:e,isAuthenticated:a.isAuthenticated(),user:a.user})})}else b.redirect("/login")}),routerf.post("/efridge",function(a,b,c){var d={isAthenticated:a.isAuthenticated(),user:a.user},e={food_name:a.body.food_name,brand:a.body.brand,serving_size:a.body.serving_size,total_calories:a.body.total_calories,fat_grams:a.body.fat_grams,carbohydrate_grams:a.body.carbohydrate_grams,protein_grams:a.body.protein_grams,total_grams:a.body.total_grams,user_id:d.user.user_id};connection.query("insert into efridge set ?",e,function(a,c){return a?void console.error(a):void b.redirect("/efridge")})}),module.exports=routerf;var express=require("express"),routerg=express.Router(),mysql=require("mysql"),connection=require("../public/javascripts/require"),expressSession=require("express-session"),passport=require("passport"),passportLocal=require("passport-local");routerg.get("/egym",function(a,b,c){var d={isAuthenticated:a.isAuthenticated(),user:a.user};if(d.isAuthenticated){var e;connection.query("select * from  egym",function(c,d){e=d,c||b.render("egym",{title:"My e-gym",description:"Checkout your workouts!",data:e,isAuthenticated:a.isAuthenticated(),user:a.user}),c&&console.log(c)})}else b.redirect("/login")}),routerg.get("/logout",function(a,b){a.logout(),b.redirect("/")}),module.exports=routerg;var express=require("express"),router=express.Router(),mysql=require("mysql"),connection=require("../public/javascripts/require"),expressSession=require("express-session"),passport=require("passport"),passportLocal=require("passport-local"),easyPbkdf2=require("easy-pbkdf2")();const crypto=require("crypto");router.get("/logout",function(a,b){a.logout(),b.redirect("/login")}),router.get("/",function(a,b,c){var d={isAuthenticated:a.isAuthenticated(),user:a.user};d.isAuthenticated?b.render("index",{title:"My e-tools",isAuthenticated:a.isAuthenticated(),user:a.user}):b.redirect("/login")}),router.post("/",passport.authenticate("local-login",{failureRedirect:"/login"}),function(a,b){b.redirect("/")}),router.post("/register",function(a,b,c){var d=a.body.passWord,e=easyPbkdf2.generateSalt();const f=crypto.pbkdf2Sync(d,e,1e5,512,"sha512");var g=f.toString("hex"),h={email:a.body.userEmail,firstname:a.body.firstName,lastname:a.body.lastName,username:a.body.userName,password:a.body.passWord,user_salt:e,password:g};connection.query("insert into users set ?",h,function(a,c){return a?(console.error(a),void b.render("index",{title:"MyColo",erobj:"Please enter a valid and unique email address."})):void b.redirect("/login")})}),module.exports=router;var express=require("express"),routerl=express.Router(),mysql=require("mysql"),connection=require("../public/javascripts/require"),expressSession=require("express-session"),passport=require("passport"),passportLocal=require("passport-local");routerl.get("/logout",function(a,b){a.logout(),b.redirect("/")}),routerl.get("/login",function(a,b,c){b.render("login",{title:"MyColoFitness"})}),routerl.post("/login",passport.authenticate("local-login",{failureRedirect:"/login"}),function(a,b){b.redirect("/")}),routerl.post("/register",function(a,b,c){var d={email:a.body.userEmail,firstname:a.body.firstName,lastname:a.body.lastName,username:a.body.userName,password:a.body.passWord};connection.query("insert into users set ?",d,function(a,c){return a?(console.error(a),void b.render("index",{title:"MyColo",erobj:"Please enter a valid and unique email address."})):void b.redirect("/login")})}),module.exports=routerl,function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){e.hasAttribute("hidden")?e.removeAttribute("hidden"):console.log("err")}var e=document.getElementById("registerDiv"),f=document.getElementById("btntest4");f.addEventListener("click",d,!1),b.exports=d,b.exports=f},{}]},{},[1]),function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){var a=document.getElementById("foodData"),b=document.getElementById("dataSearch");a.hasAttribute("hidden")?(a.removeAttribute("hidden"),b.removeAttribute("hidden"),foodProfile.setAttribute("hidden","true")):console.log("err")}function e(){var a=document.getElementById("foodProfile");a.hasAttribute("hidden")?(a.removeAttribute("hidden"),foodData.setAttribute("hidden","true"),dataSearch.setAttribute("hidden","true")):console.log("err")}var f=document.getElementById("btntest3");f.addEventListener("click",d,!1);var g=document.getElementById("btntest1");g.addEventListener("click",e,!1),b.exports=d,b.exports=e,b.exports=g},{}]},{},[1]),function c(a,b,d){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,c,a,b,d)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){var a=document.getElementById("workoutData"),b=document.getElementById("workSearch");a.hasAttribute("hidden")?(a.removeAttribute("hidden"),b.removeAttribute("hidden"),workProfile.setAttribute("hidden","true")):console.log("err")}function e(){var a=document.getElementById("workProfile");a.hasAttribute("hidden")?(a.removeAttribute("hidden"),workoutData.setAttribute("hidden","true"),workSearch.setAttribute("hidden","true")):console.log("err")}var f=document.getElementById("btnworkget");f.addEventListener("click",d,!1);var g=document.getElementById("btnworkpos");g.addEventListener("click",e,!1),b.exports=d,b.exports=e,b.exports=g},{}]},{},[1]);var mysql=require("mysql"),connection=mysql.createConnection({host:"localhost",user:"tulsi",password:"Yoni3454!",database:"freetools"});connection.query("USE freetools"),module.exports=connection;